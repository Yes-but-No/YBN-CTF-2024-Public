#include <stdio.h>

int main() {
    //unsigned char shellcode[] = "\x55\x48\x89\xe5\x48\x89\x7d\xe8\x48\x89\x75\xe0\x48\x89\x55\xd8\xc7\x45\xfc\x00\x00\x00\x00\xc7\x45\xf4\x00\x00\x00\x00\xeb\x74\x8b\x55\xf4\x48\x8b\x45\xe8\x48\x01\xd0\x0f\xb6\x00\x0f\xbe\xc0\x89\x45\xf8\xc7\x45\xf0\x00\x00\x00\x00\xeb\x1f\x8b\x45\xf8\xc1\xe0\x0d\x31\x45\xf8\x8b\x45\xf8\xc1\xe8\x11\x31\x45\xf8\x8b\x45\xf8\xc1\xe0\x05\x31\x45\xf8\x83\x45\xf0\x01\x8b\x45\xf4\x48\x8d\x14\x85\x00\x00\x00\x00\x48\x8b\x45\xd8\x48\x01\xd0\x8b\x00\x39\x45\xf0\x72\xc8\x8b\x45\xf4\x48\x8d\x14\x85\x00\x00\x00\x00\x48\x8b\x45\xe0\x48\x01\xd0\x8b\x00\x8b\x55\xf8\x29\xc2\x09\x55\xfc\x83\x45\xf4\x01\x8b\x45\xf4\x48\x8d\x14\x85\x00\x00\x00\x00\x48\x8b\x45\xe0\x48\x01\xd0\x8b\x00\x85\xc0\x0f\x85\x70\xff\xff\xff\x8b\x45\xfc\x5d\xc3";

    unsigned char shellcode[] = "\x55\x48\x89\xe5\x48\x89\x7d\xe8\x48\x89\x75\xe0\x48\x89\x55\xd8\xc7\x45\xf0\x00\x00\x00\x00\xc7\x45\xf8\x00\x00\x00\x00\xe9\x8e\x00\x00\x00\x8b\x55\xf8\x48\x8b\x45\xe8\x48\x01\xd0\x0f\xb6\x00\x0f\xbe\xc0\x89\x45\xfc\xc7\x45\xf4\x00\x00\x00\x00\xeb\x1f\x8b\x45\xfc\xc1\xe0\x0d\x31\x45\xfc\x8b\x45\xfc\xc1\xe8\x11\x31\x45\xfc\x8b\x45\xfc\xc1\xe0\x05\x31\x45\xfc\x83\x45\xf4\x01\x8b\x45\xf8\x48\x8d\x14\x85\x00\x00\x00\x00\x48\x8b\x45\xd8\x48\x01\xd0\x8b\x00\x39\x45\xf4\x72\xc8\x8b\x45\xf8\x48\x8d\x14\x85\x00\x00\x00\x00\x48\x8b\x45\xe0\x48\x01\xd0\x8b\x00\x39\x45\xfc\x74\x1d\x8b\x45\xf8\x48\x8d\x14\x85\x00\x00\x00\x00\x48\x8b\x45\xe0\x48\x01\xd0\x8b\x00\x8b\x55\xfc\x29\xc2\x89\xd0\xeb\x23\x83\x45\xf8\x01\x8b\x45\xf8\x48\x8d\x14\x85\x00\x00\x00\x00\x48\x8b\x45\xe0\x48\x01\xd0\x8b\x00\x85\xc0\x0f\x85\x56\xff\xff\xff\x8b\x45\xf0\x5d\xc3";

        unsigned char hic = '\x12';
    printf("unsigned char enc_val = %x;\n", hic);
    printf("unsigned char shellcode[] = \"");
    for(int i = 0; i < sizeof(shellcode)-1; i++) {
        printf("\\x%x", (hic ^ shellcode[i]) & 0xff);
    }
    printf("\";\n");
    return 0;
}
