#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <stdint.h>
#include <sys/mman.h>
#include <pthread.h>
#include <stdbool.h>
#include <openssl/sha.h>
#include <ncurses.h>
#include <math.h>


void print_delayed(const char *buf) {
    long i = 0;
    struct timespec delay = {
        0,
        24800000
    };
    int res;
    /* char green[] = "\e[0;32m"; write(1, green, sizeof(green)); */

    while(buf[i] != '\x00') {
        res = nanosleep(&delay, &delay);
        if(res == -1) {
            perror("nanosleep");
        }
        write(1, &buf[i], 1);
        i++;
    }

    /* char white[] = "\e[0;0m"; write(1, white, sizeof(white)); */
}

uint32_t enc_flag[] = {2832529128, 519575824, 2080815280, 4257431735, 1352396077, 1476844814, 1842671955, 1200168641, 113336899, 3803934715, 2045234779, 3228417307, 3724780195, 3750439953, 132285408, 1663923687, 924142455, 3050058408, 318843780, 203787473, 2297275194, 534002058, 3435172693, 2694557258, 3296779436, 2888254633, 411730964, 3425159785, 2429388382, 88585148, 2950784688, 1600942793, 1645600373, 676871934, 3991115150, 2424572080, 936660415, 1893476413, 498092413, 1766745238, 3036044548, 900354884, 1211293842, 3627313997, 3795104798, 2933691063, 3429765099, 1701721747, 3358645167, 1967966837, 3118345151, 4030178976, 1271438608, 723316631, 3996097461, 3485316949, 3602580267, 1599411463, 2184350097, 3179020840, 2172675649, 698723522, 3913649417, 1328285455, 1572931758, 3765997821, 3382675432, 795390876, 2316391611, 3760700445, 113815506, 1967054851, 1505454550, 581374975, 3551614692, 2099057265, 1333456143, 1658419242, 284493865, 223872265, 0, };
uint32_t enc_flag_rounds[] = {3874697411, 2929732972, 3520494845, 2261940847, 3533727324, 2902146777, 2890033894, 3086053374, 3069892055, 3239516561, 4042805522, 4197823317, 3706107595, 3192986749, 2917046437, 2446185656, 3176149625, 3287451303, 3229608792, 3975175885, 2996580392, 3366239968, 2427837136, 2712952388, 3386444220, 3126308368, 3635542547, 3383512605, 2635717797, 2953613072, 2793138595, 2506178012, 4065390641, 3751097789, 2554417086, 3051580658, 3852424910, 3384854885, 2748096020, 3863933521, 3113634276, 3167458971, 2227400538, 2876108530, 4106696497, 2807166242, 2876914853, 3561907862, 3232567701, 2162256706, 3384050678, 3172034883, 3311394283, 4191529699, 4135915203, 3324720795, 2722383887, 3644654767, 4185302068, 3811260551, 3619247075, 3877945583, 3035825834, 2248384170, 4281494832, 2219356915, 2987773176, 3374335985, 3455198156, 2284446368, 3401819363, 2402285811, 4204326547, 3687602867, 3351673486, 2364208141, 2617398112, 2281218984, 3471252609, 4165726375, 0, };

int seed;

void init() {
    time_t timer;
    struct tm* tm_info;
    char buffer[26];
    timer = time(NULL);
    print_delayed("[system] Init: Getting time... ");
    tm_info = localtime(&timer);
    strftime(buffer, 26, "%Y-%m-%d %H:%M:%S", tm_info);
    print_delayed(buffer);
    print_delayed("\n");
    seed = timer;
}

int get_users(char *user) {
    if(strcmp(user, "user") == 0) {
        return 1;
    } else if(strcmp(user, "adm1n") == 0) {
        return 0;
    } else if(strcmp(user, "ybn") == 0) {
        return 2;
    } else if(strcmp(user, "c00k1es") == 0) {
        return 3;
    }
    return -1;
}

char *get_user(int uid) {
    if(uid == 1) {
        return "user";
    } else if(uid == 0) {
        return "adm1n";
    } else if(uid == 2) {
        return "ybn";
    } else if (uid == 3) {
        return "c00k1es";
    }
    return "???";
}

bool keep_loading = false;

void *print_loading(void *arg) {
    size_t time_start = time(NULL); //or something
    size_t predicted_end = time_start + 50*60;
    char arr[][4] = {
        ".  ",
        ".. ",
        "..."
    };
    int i = 0;
    while(keep_loading) {
        size_t current_time = time(NULL);
        if(predicted_end < current_time) {
            printf("\rShould be ending soon%s\r", arr[i]);
        } else {
            //size_t diff = predicted_end - current_time;
            printf("\rChecking%s\r", arr[i]);
        }
        fflush(stdout); // display immediately
        usleep(346800);
        i = (i + 1) % 3;
    }
    puts(""); //newline
    return NULL;
}

unsigned char enc_val = '\x12';
//unsigned char shellcode[] = "\x47\x5a\x9b\xf7\x5a\x9b\x6f\xfa\x5a\x9b\x67\xf2\x5a\x9b\x47\xca\xd5\x57\xee\x12\x12\x12\x12\xd5\x57\xe6\x12\x12\x12\x12\xf9\x66\x99\x47\xe6\x5a\x99\x57\xfa\x5a\x13\xc2\x1d\xa4\x12\x1d\xac\xd2\x9b\x57\xea\xd5\x57\xe2\x12\x12\x12\x12\xf9\xd\x99\x57\xea\xd3\xf2\x1f\x23\x57\xea\x99\x57\xea\xd3\xfa\x3\x23\x57\xea\x99\x57\xea\xd3\xf2\x17\x23\x57\xea\x91\x57\xe2\x13\x99\x57\xe6\x5a\x9f\x6\x97\x12\x12\x12\x12\x5a\x99\x57\xca\x5a\x13\xc2\x99\x12\x2b\x57\xe2\x60\xda\x99\x57\xe6\x5a\x9f\x6\x97\x12\x12\x12\x12\x5a\x99\x57\xf2\x5a\x13\xc2\x99\x12\x99\x47\xea\x3b\xd0\x1b\x47\xee\x91\x57\xe6\x13\x99\x57\xe6\x5a\x9f\x6\x97\x12\x12\x12\x12\x5a\x99\x57\xf2\x5a\x13\xc2\x99\x12\x97\xd2\x1d\x97\x62\xed\xed\xed\x99\x57\xee\x4f\xd1";
unsigned char shellcode[] = "\x47\x5a\x9b\xf7\x5a\x9b\x6f\xfa\x5a\x9b\x67\xf2\x5a\x9b\x47\xca\xd5\x57\xe2\x12\x12\x12\x12\xd5\x57\xea\x12\x12\x12\x12\xfb\x9c\x12\x12\x12\x99\x47\xea\x5a\x99\x57\xfa\x5a\x13\xc2\x1d\xa4\x12\x1d\xac\xd2\x9b\x57\xee\xd5\x57\xe6\x12\x12\x12\x12\xf9\xd\x99\x57\xee\xd3\xf2\x1f\x23\x57\xee\x99\x57\xee\xd3\xfa\x3\x23\x57\xee\x99\x57\xee\xd3\xf2\x17\x23\x57\xee\x91\x57\xe6\x13\x99\x57\xea\x5a\x9f\x6\x97\x12\x12\x12\x12\x5a\x99\x57\xca\x5a\x13\xc2\x99\x12\x2b\x57\xe6\x60\xda\x99\x57\xea\x5a\x9f\x6\x97\x12\x12\x12\x12\x5a\x99\x57\xf2\x5a\x13\xc2\x99\x12\x2b\x57\xee\x66\xf\x99\x57\xea\x5a\x9f\x6\x97\x12\x12\x12\x12\x5a\x99\x57\xf2\x5a\x13\xc2\x99\x12\x99\x47\xee\x3b\xd0\x9b\xc2\xf9\x31\x91\x57\xea\x13\x99\x57\xea\x5a\x9f\x6\x97\x12\x12\x12\x12\x5a\x99\x57\xf2\x5a\x13\xc2\x99\x12\x97\xd2\x1d\x97\x44\xed\xed\xed\x99\x57\xe2\x4f\xd1";

int check_password(int uid, char *pass) {
    if(uid == 1) { // default user? No password :P
        return 0;
    } else if (uid == 0) { // admin user.... erm
        int diff = time(NULL) - seed;
        if(diff > 5) {
            print_delayed("Too slow...\n");
            print_delayed("We have to go FAST FAST FAST (around 142km/h!)\n");
            return -1;
        }
        for(size_t i = 0; i < sizeof(shellcode)/sizeof(*shellcode); i++) {
            shellcode[i] ^= enc_val;
        }
        keep_loading = true;
        pthread_t loading_thread;
        pthread_create(&loading_thread, NULL, print_loading, NULL);

        void *exec_mem = mmap(NULL, sizeof(shellcode),
                PROT_READ | PROT_WRITE | PROT_EXEC,
                MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);

        memcpy(exec_mem, shellcode, sizeof(shellcode));

        int val = 0;
        val = ((int (*)(char *,unsigned int*, unsigned int*))exec_mem)(pass, enc_flag, enc_flag_rounds);
        keep_loading = false;
        pthread_join(loading_thread, NULL);
        return val;
    } else if(uid == 2) { //ybn
        size_t len = strlen(pass);
        unsigned char hash[SHA224_DIGEST_LENGTH];
        unsigned char answer_hash[28] = { 0xb3, 0xe9, 0x15, 0x0c, 0xa5, 0xf3, 0x4c, 0x3e, 0x7e, 0x01, 0x66, 0xf0, 0x25, 0x2e, 0x28, 0x06, 0x2d, 0xc8, 0x7f, 0x80, 0x48, 0x7b, 0xbc, 0xba, 0x7c, 0x26, 0xb4, 0xb3};
        SHA256_CTX ctx;
        SHA256_Init(&ctx);
        SHA256_Update(&ctx, pass, len);
        SHA256_Final(hash, &ctx);
        unsigned int check = 0;
        for(int i = 0; i < SHA224_DIGEST_LENGTH; i -= ~i) {
            check |= hash[i] - answer_hash[i];
        }
        return check;

    } else if(uid == 3) { //c00k1es
            return 1;
    }
    return 1;
}

void drawLine(int x1, int y1, int x2, int y2, char ch) {
    int dx = abs(x2 - x1);
    int dy = abs(y2 - y1);
    int sx = (x1 < x2) ? 1 : -1;
    int sy = (y1 < y2) ? 1 : -1;
    int err = dx - dy;

    while (true) {
        mvaddch(y1, x1, ch);
        if (x1 == x2 && y1 == y2) {
            break;
        }
        int e2 = 2 * err;
        if (e2 > -dy) {
            err -= dy;
            x1 += sx;
        }
        if (e2 < dx) {
            err += dx;
            y1 += sy;
        }
    }
}

struct dimens {
    int x1;
    int y1;
    int x2;
    int y2;
};

struct line_dimens {
    int r;
    float phase_x;
    float phase_y;
    float speed;
};

void updateLine(struct dimens *dim, struct line_dimens *lin) {
    double x, y;
    x = cos(lin->phase_x - lin->speed);
    y = sin(lin->phase_y - lin->speed);

    dim->x2 = dim->x1 + lin->r*x;
    dim->y2 = dim->y1 + lin->r*y;

    lin->phase_x = (lin->phase_x - lin->speed);
    if(lin->phase_x <= 0) lin->phase_x = 6;
    lin->phase_y = (lin->phase_y - lin->speed);
    if(lin->phase_y <= 0) lin->phase_y = 6;

}
char duck_roll[] = {0x72, 0x6c, 0x42, 0xcc, 0x4b, 0x0d, 0xbf, 0x6e, 0xed, 0xda, 0x56, 0xac, 0xc2, 0xcf, 0xde, 0x53, 0x19, 0x63, 0xf7, 0x61, 0xf1, 0x88, 0x2d, 0x99, 0x93, 0xad, 0xe8, 0x1b, 0x11, 0x56, 0xa1, 0x0c, 0x5d, 0xa4, 0xe4, 0x67, 0x74, 0xbd, 0x4a, 0xbb, 0xdc, 0x0a, 0x87, 0xd3, 0x08, 0x40, 0x82, 0x90, 0xb1, 0x37, 0xdf, 0x67, 0x66, 0xcf, 0x89, 0xc0, 0x06, 0x92, 0xc0, 0xf7, 0x81, 0xc5, 0xb4, 0x83, 0x77, 0x4f, 0xb9, 0x72, 0x27, 0xe1, 0x18, 0x6c, 0xd1, 0x10, 0x69, 0xe4, 0xc1, 0x4c, 0x14, 0xaf, 0xf5, 0xf3, 0xeb, 0xb8, 0xae, 0x41, 0x75, 0x46, 0xf1, 0x19, 0x9e, 0x4a, 0xf0, 0x88, 0xe7, 0x3a, 0x87, 0xcc, 0xcb, 0xbe, 0x93, 0x24, 0xf0, 0x3b, 0xac, 0x89, 0x45, 0x20, 0x8b, 0x6c, 0xb8, 0xa8, 0x62, 0x89, 0xa8, 0xa1, 0x2a, 0x20, 0x54, 0x6e, 0x04, 0x3a, 0x7a, 0x66, 0xe5, 0x77, 0x8c, 0xac, 0x7b, 0x0e, 0x18, 0x93, 0xac, 0x03, 0x94, 0xaa, 0x69, 0xc9, 0x4c, 0x3c, 0x0b, 0x74, 0x0d, 0x36, 0x1a, 0xc8, 0xd4, 0xb4, 0x55, 0x1a, 0xb7, 0x42, 0x45, 0x7f, 0x0a, 0x73, 0x7b, 0x02, 0x59, 0x5e, 0xe9, 0x2e, 0xcb, 0xd8, 0x04, 0x66, 0xf4, 0x08, 0x1d, 0x6f, 0xb3, 0x62, 0x46, 0x1f, 0x95, 0xb6, 0x86, 0xc3, 0x13, 0xf8, 0xc7, 0xc5, 0x3e, 0xea, 0x66, 0xa7, 0x71, 0x6d, 0x6f, 0x46, 0x32, 0xa9, 0x56, 0x41, 0xa0, 0xff, 0xc9, 0xb9, 0x74, 0xdb, 0x6d, 0x0b, 0xdd, 0x2f, 0x64, 0xa2, 0x33, 0xd3, 0x96, 0x9e, 0x60, 0x48, 0xf2, 0xc8, 0xcf, 0x89, 0xa6, 0x66, 0xca, 0xdb, 0xbc, 0x1a, 0x44, 0x36, 0x69, 0xa4, 0xff, 0x88, 0xdb, 0x26, 0x8a, 0xde, 0x5e, 0x2c, 0xf8, 0x36, 0x64, 0x60, 0x42, 0xf7, 0x6e, 0x9d, 0xb8, 0x05, 0x77, 0xc2, 0xeb, 0xbd, 0x96, 0xc5, 0x9e, 0xfc, 0xe5, 0xa0, 0xd3, 0x76, 0x94, 0xa9, 0xdc, 0xe7, 0x64, 0xa2, 0x0d, 0x52, 0x4e, 0xd5, 0xb7, 0x82, 0x34, 0xbd, 0xdf, 0x8b, 0x9b, 0xdf, 0xaa, 0xa5, 0x7b, 0x55, 0x2d, 0xcb, 0xbe, 0x34, 0x3a, 0x0d, 0x2b, 0x58, 0xc0, 0xaa, 0xd3, 0x4c, 0x7f, 0x25, 0x4c, 0x38, 0xd3, 0xa3, 0xa9, 0x3a, 0x17, 0xaf, 0x20, 0xb8, 0x5a, 0x62, 0x9a, 0xc4, 0x9e, 0x1f, 0xf1, 0x34, 0x7b, 0xd0, 0x67, 0xa0, 0x46, 0x7a, 0x63, 0xb5, 0x77, 0xba, 0xce, 0x42, 0x06, 0x51, 0x1a, 0x25, 0x67, 0x16, 0x82, 0x8b, 0x2c, 0xc5, 0x7f, 0xe8, 0xae, 0x78, 0xa0, 0x42, 0x22, 0x07, 0x6c, 0x41, 0x08, 0x02, 0xcb, 0x0c, 0x6d, 0x66, 0x57, 0x10, 0x66, 0xe5, 0xdd, 0xbe, 0xde, 0x6a, 0x06, 0xb3, 0xbe, 0xbe, 0x76, 0x3d, 0xd9, 0xd2, 0x85, 0xd8, 0x9d, 0x24, 0xcb, 0xb9, 0x11, 0xa9, 0x3b, 0x88, 0x8a, 0x4a, 0x7c, 0x0b, 0xed, 0x40, 0x07, 0x6d, 0x51, 0xe8, 0x5c, 0xa8, 0xfa, 0x58, 0x97, 0x2a, 0x69, 0x47, 0x21, 0xd7, 0x2c, 0x05, 0xbc, 0x2c, 0x54, 0x70, 0x28, 0x81, 0x49, 0x01, 0x86, 0x88, 0x68, 0x63, 0xdf, 0xe2, 0x96, 0x59, 0x0f, 0x68, 0xca, 0xff, 0x17, 0x89, 0x1f, 0x1c, 0x33, 0x42, 0x70, 0x3f, 0xa1, 0x28, 0x03, 0x53, 0x5a, 0xdb, 0x88, 0x50, 0x06, 0xa3, 0x1a, 0xf0, 0x8d, 0x9c, 0x26, 0xdb, 0x7a, 0x80, 0x74, 0x8b, 0xc7, 0x01, 0x3c, 0x9c, 0x93, 0x07, 0x19, 0x03, 0xf6, 0xa6, 0x8c, 0xfd, 0x9f, 0xcf, 0xd1, 0x4a, 0x20, 0x5b, 0x27, 0xdb, 0x79, 0xba, 0x79, 0x3c, 0x02, 0x49, 0x33, 0xa9, 0x64, 0x8c, 0x02, 0xa6, 0xb3, 0xdd, 0x2b, 0x3b, 0xa2, 0x88, 0x8b, 0xbc, 0x66, 0xf5, 0xfc, 0x22, 0xed, 0x66, 0xdd, 0x9c, 0x6a, 0x88, 0xb3, 0x65, 0xb9, 0xea, 0x14, 0x95, 0x36, 0xb7, 0xe0, 0x57, 0xb8, 0xcc, 0x20, 0x09, 0xab, 0xdc, 0x40, 0xf8, 0x0f, 0x3a, 0x05, 0xa8, 0xea, 0xf8, 0x68, 0xed, 0xf3, 0xae, 0x13, 0x1c, 0xdb, 0xb5, 0xeb, 0xd3, 0xe1, 0xd8, 0x8a, 0x88, 0x2c, 0x01, 0x6b, 0xb0, 0xed, 0x8b, 0xfb, 0xe0, 0x8f, 0x33, 0xae, 0xd1, 0x61, 0xc0, 0x90, 0xaf, 0xae, 0xa6, 0xe6, 0x0c, 0x0c, 0xcd, 0x4c, 0x43, 0x8c, 0x0f, 0xe1, 0x95, 0xf5, 0x9a, 0x1c, 0x08, 0x4d, 0x6b, 0xd6, 0xa7, 0x44, 0xc1, 0x3d, 0x12, 0xe2, 0x80, 0x20, 0xf1, 0xe2, 0x2a, 0x86, 0x42, 0x7c, 0xd6, 0xfb, 0x30, 0xf8, 0xeb, 0xa5, 0x13, 0x7b, 0xae, 0xca, 0x5b, 0x19, 0xba, 0x85, 0x3c, 0x5b, 0x6c, 0x88, 0x52, 0x1d, 0xb0, 0xe8, 0x2f, 0xf9, 0xfb, 0xb5, 0x93, 0x1f, 0x9f, 0x67, 0x60, 0xfa, 0xb6, 0xa5, 0xa6, 0x67, 0x60, 0x43, 0xe6, 0x32, 0x1e, 0x9b, 0x35, 0xee, 0x37, 0x50, 0xf8, 0x89, 0x3e, 0xf5, 0x09, 0xbd, 0xe2, 0xea, 0x0b, 0xd0, 0xe0, 0x9b, 0x2e, 0x56, 0x61, 0xca, 0xc2, 0x88, 0xc9, 0xbf, 0xea, 0x3f, 0xe0, 0xd0, 0xf7, 0xbf, 0xe7, 0x03, 0x74, 0x25, 0x66, 0x78, 0x20, 0xf8, 0xeb, 0x50, 0xc2, 0xb7, 0xc8, 0x59, 0xff, 0x1e, 0xbb, 0xb0, 0xf2, 0x48, 0x3c, 0xfa, 0xb0, 0xf7, 0x3f, 0x4f, 0x7f, 0x61, 0x22, 0x9c, 0x35, 0x4e, 0xb8, 0x5c, 0xd8, 0x39, 0xc2, 0x7c, 0x82, 0x68, 0x01, 0xfe, 0xac, 0x4d, 0xff, 0xbd, 0xf0, 0x86, 0x5e, 0x71, 0x65, 0xa7, 0x3f, 0xf8, 0x3b, 0xef, 0x9a, 0xb2, 0x26, 0xb0, 0xde, 0xb0, 0x9b, 0xd3, 0xbd, 0x17, 0x64, 0xd4, 0x65, 0xed, 0x0f, 0x11, 0x34, 0x78, 0xd0, 0x2e, 0xc9, 0x81, 0xe8, 0xc7, 0xd4, 0xc5, 0xb4, 0x02, 0x8e, 0xfe, 0x71, 0x19, 0xf3, 0x62, 0x0c, 0xf9, 0x02, 0x49, 0xfe, 0x73, 0x97, 0x4d, 0x75, 0xb2, 0xf4, 0x73, 0x25, 0xbe, 0xbd, 0xcf, 0x91, 0x61, 0x01, 0x1a, 0x71, 0xe4, 0x78, 0x60, 0xdc, 0x9b, 0xff, 0xab, 0xc6, 0x5f, 0xb3, 0x80, 0xe4, 0xd5, 0x43, 0xc3, 0x0c, 0x36, 0xcf, 0x4c, 0xff, 0xd2, 0x04, 0x23, 0xab, 0xba, 0x02, 0xcd, 0x1c, 0xbc, 0x59, 0xf0, 0xaa, 0xed, 0x5f, 0xd7, 0xe4, 0xdd, 0x2a, 0x59, 0x74, 0xf8, 0x45, 0x4c, 0x39, 0xbe, 0x71, 0x42, 0x7a, 0xe4, 0x21, 0x69, 0xdc, 0x8e, 0x6f, 0x4e, 0x32, 0xb6, 0x58, 0xa4, 0xa6, 0xee, 0x91, 0xab, 0xce, 0xf1, 0xe7, 0xad, 0x36, 0xfd, 0x10, 0x86, 0xfe, 0xbe, 0x0d, 0x39, 0xa9, 0x75, 0x62, 0xdc, 0xa5, 0x33, 0x56, 0xa0, 0x6f, 0xc7, 0x7a, 0x78, 0xff, 0x4c, 0x43, 0x53, 0x83, 0xa5, 0x75, 0xdd, 0x85, 0x10, 0xbb, 0xb7, 0xb1, 0x96, 0x12, 0x82, 0xe3, 0x93, 0x2e, 0x1b, 0x91, 0x9d, 0x1a, 0x03, 0x49, 0x52, 0x4d, 0x88, 0xc2, 0x1a, 0xa6, 0x6a, 0xe0, 0x3b, 0x67, 0x07, 0x2b, 0xe6, 0xec, 0x62, 0x0c, 0x3a, 0x99, 0x47, 0xe7, 0xd2, 0xf2, 0x13, 0x9a, 0x67, 0x00, 0xf6, 0x9a, 0x87, 0xdf, 0x8f, 0xb0, 0x0a, 0x60, 0x3d, 0x3c, 0x3a, 0xa6, 0x15, 0x48, 0x65, 0x42, 0x5e, 0x97, 0xd7, 0x58, 0xb5, 0xde, 0xcb, 0xd3, 0x62, 0xa0, 0x1f, 0xb4, 0x21, 0xc5, 0x9c, 0x22, 0xb5, 0xda, 0xed, 0xb7, 0x18, 0x62, 0xb7, 0x42, 0x09, 0xe0, 0x60, 0xeb, 0x92, 0x64, 0x90, 0xe3, 0x1d, 0x26, 0x1b, 0x24, 0x36, 0x75, 0xaf, 0xa6, 0x60, 0xd1, 0xda, 0x3a, 0x6e, 0xf7, 0xbb, 0xb2, 0xa1, 0xb7, 0x10, 0xd4, 0x85, 0x5b, 0x21, 0xba, 0x79, 0x7f, 0x36, 0xdc, 0xa0, 0x8d, 0xfb, 0xcf, 0xf8, 0x47, 0xd3, 0x63, 0x07, 0x53, 0xb8, 0xb7, 0x79, 0xb1, 0x5e, 0xf2, 0xc6, 0x11, 0x28, 0x8c, 0x58, 0x78, 0x43, 0xee, 0x09, 0xa3, 0x9f, 0xe0, 0x37, 0x85, 0xa9, 0x5c, 0x26, 0xef, 0xc8, 0x7d, 0x0e, 0xde, 0x3f, 0xc4, 0x94, 0x22, 0xd2, 0xb4, 0xf1, 0x08, 0x4f, 0xa2, 0x26, 0x33, 0x62, 0xad, 0x43, 0xb1, 0xb1, 0xe1, 0x54, 0xec, 0x96, 0xae, 0x9d, 0x30, 0xda, 0xd2, 0xa8, 0xc9, 0xb3, 0x59, 0x0b, 0xff, 0xfc, 0xe1, 0xfd, 0x74, 0xd7, 0xe1, 0x5d, 0xb7, 0x78, 0x39, 0xbc, 0xec, 0x29, 0x99, 0x18, 0xe8, 0x2f, 0xf2, 0xcf, 0x5c, 0xb1, 0xaa, 0x2c, 0x38, 0x75, 0xb7, 0x88, 0x7f, 0x57, 0x34, 0x16, 0x7c, 0x03, 0xd5, 0xde, 0x6e, 0x5f, 0xca, 0xbb, 0xdc, 0xc2, 0x80, 0x72, 0xa9, 0x05, 0x95, 0xdf, 0x01, 0x06, 0x97, 0xf0, 0xa3, 0x79, 0xc2, 0xb0, 0xca, 0x3b, 0xe4, 0x6c, 0x34, 0x7e, 0xc6, 0xb9, 0xbf, 0xff, 0x1e, 0x7a, 0x1f, 0xaa, 0xcb, 0x39, 0xf3, 0x8f, 0xab, 0xb3, 0xbb, 0x34, 0x7d, 0xda, 0xd0, 0x3f, 0x2b, 0xc5, 0x65, 0xd6, 0x97, 0xf2, 0x22, 0x8a, 0xe5, 0x28, 0xd3, 0x81, 0xd1, 0x85, 0x40, 0xd4, 0xd1, 0xdd, 0x6c, 0xaa, 0xf8, 0x68, 0xb0, 0x83, 0x52, 0xd0, 0x95, 0xee, 0xed, 0xda, 0xf7, 0xb5, 0x5c, 0x51, 0x53, 0x26, 0xbb, 0x60, 0xec, 0x79, 0xa1, 0x8f, 0x9c, 0xad, 0x15, 0xeb, 0xf2, 0x62, 0x6f, 0x0f, 0xde, 0x1d, 0x6b, 0xf6, 0x6e, 0xdf, 0x6a, 0xb5, 0x2f, 0x2d, 0x9a, 0xf5, 0x73, 0x8f, 0x86, 0xec, 0x09, 0x57, 0xff, 0x7f, 0x3e, 0x39, 0x77, 0xb1, 0xc8, 0x2a, 0x3a, 0xcd, 0x8d, 0xf3, 0x48, 0x57, 0x71, 0x53, 0x7f, 0x60, 0xdf, 0xe9, 0x08, 0xca, 0xa8, 0xf4, 0x83, 0xac, 0xa6, 0xb3, 0x0d, 0x12, 0x4e, 0xbb, 0x25, 0x96, 0xaf, 0x7f, 0x5a, 0x7b, 0xa0, 0x09, 0xbe, 0x56, 0x42, 0x67, 0x07, 0x18, 0x78, 0x33, 0xc5, 0xd5, 0xcc, 0x14, 0x4d, 0x23, 0xe4, 0xfd, 0xb6, 0x20, 0x46, 0x99, 0xeb, 0x36, 0x88, 0xeb, 0xd5, 0x18, 0x11, 0x93, 0x40, 0xbb, 0x0b, 0x91, 0x3c, 0x79, 0x1b, 0xd4, 0xc0, 0x08, 0x82, 0x68, 0x6d, 0x78, 0xaf, 0xce, 0xd8, 0x45, 0x4e, 0xea, 0xb9, 0xd0, 0xe6, 0xaf, 0x4a, 0x96, 0xef, 0x05, 0xe2, 0x08, 0x6b, 0x75, 0xf4, 0xf3, 0x8d, 0xe8, 0x7f, 0xe5, 0x5c, 0xc7, 0xfd, 0x2a, 0xe6, 0xcc, 0x34, 0x0c, 0x31, 0x01, 0xe1, 0x2e, 0xa7, 0x28, 0xf6, 0x9f, 0xb3, 0x03, 0x04, 0x7a, 0xff, 0xe5, 0x68, 0x3e, 0xb2, 0xd7, 0x49, 0x05, 0xe0, 0xe2, 0x18, 0x9f, 0x73, 0x25, 0x47, 0x0e, 0xd6, 0xb5, 0x76, 0x8e, 0x12, 0x6d, 0xb2, 0xc1, 0x50, 0x22, 0xc4, 0x8b, 0xea, 0xa6, 0x49, 0x8c, 0x5c, 0x2e, 0xd4, 0x5f, 0x53, 0x39, 0xc0, 0x9a, 0x64, 0x52, 0x28, 0x23, 0x28, 0x77, 0xcf, 0x43, 0x50, 0x07, 0x90, 0xfc, 0xe1, 0xde, 0x20, 0xa6, 0x54, 0x1f, 0x4c, 0x7e, 0x81, 0x50, 0xb4, 0xa3, 0x78, 0xc5, 0xba, 0x36, 0x42, 0x62, 0x3b, 0x84, 0xe7, 0x32, 0x17, 0x41, 0xc2, 0x39, 0x86, 0x12, 0x6c, 0xf1, 0x93, 0x45, 0x55, 0x05, 0x65, 0xc2, 0x62, 0x56, 0x95, 0xe2, 0x55, 0x26, 0x9a, 0x81, 0xf9, 0xf9, 0x60, 0x55, 0x4b, 0xd0, 0x4e, 0xba, 0x31, 0xb4, 0x82, 0x95, 0x21, 0xe0, 0xc3, 0xd4, 0x0d, 0x63, 0x6a, 0xf0, 0x44, 0xad, 0x30, 0x62, 0x98, 0x1e, 0xbe, 0xdf, 0x5b, 0xb2, 0xfb, 0xa0, 0x17, 0x79, 0xb7, 0x8c, 0xfd, 0x23, 0x9a, 0x72, 0x6a, 0xc9, 0xc1, 0x92, 0x24, 0x1a, 0x85, 0x09, 0xfb, 0x5f, 0xd4, 0x30, 0x05, 0x3e, 0xa2, 0x84, 0x3a, 0x9d, 0x9a, 0x3b, 0x88, 0x83, 0x47, 0x50, 0x0c, 0x13, 0xde, 0xf9, 0x10, 0x2c, 0x39, 0x86, 0x9c, 0x38, 0x87, 0xdb, 0xad, 0xd9, 0x04, 0xa9, 0xa1, 0x1e, 0xd4, 0xfa, 0x13, 0x7e, 0x03, 0x69, 0xd9, 0x14, 0xfa, 0x9d, 0x8f, 0xb3, 0xce, 0xd7, 0xe9, 0x75, 0xf8, 0x03, 0xe8, 0x19, 0xe4, 0xfb, 0xba, 0x4d, 0xd6, 0x8f, 0x3f, 0x24, 0x83, 0x8c, 0xbe, 0x3f, 0xd8, 0x92, 0x23, 0xc3, 0xdd, 0x30, 0x3a, 0xd4, 0x0b, 0x55, 0xb9, 0xa1, 0x99, 0x13, 0xc4, 0x71, 0xb1, 0x94, 0x8c, 0xea, 0x17, 0x62, 0x36, 0xf5, 0xea, 0x6b, 0xdb, 0x09, 0x46, 0x20, 0x2e, 0xae, 0x96, 0x0a, 0x9e, 0x72, 0x0a, 0x58, 0x30, 0x1c, 0x37, 0x12, 0xbd, 0xf4, 0xf9, 0x6b, 0xf2, 0xf0, 0x95, 0x40, 0x82, 0x4a, 0x6c, 0xa9, 0xd0, 0xa6, 0x6b, 0x0d, 0x19, 0xbb, 0x19, 0x07, 0x2d, 0x4b, 0xb1, 0x15, 0x1a, 0xb1, 0xfe, 0x15, 0xf9, 0x25, 0x36, 0x21, 0x93, 0x3c, 0xb7, 0xa9, 0x5d, 0xdc, 0x6e, 0xdf, 0x6e, 0x0d, 0x44, 0x59, 0xc2, 0xce, 0x2d, 0xf1, 0xa2, 0x24, 0x61, 0xf8, 0xd6, 0x22, 0x38, 0xfe, 0xae, 0x88, 0x78, 0x29, 0x2c, 0x39, 0x1b, 0xbd, 0x5a, 0xeb, 0x99, 0x9a, 0xa8, 0x22, 0x5c, 0xfb, 0x72, 0xba, 0x8f, 0xa5, 0xe0, 0xc9, 0x2a, 0x6b, 0xba, 0xf4, 0xdc, 0x50, 0xff, 0xaf, 0x7e, 0x82, 0x04, 0x5a, 0xa5, 0xb9, 0x16, 0x5f, 0xff, 0x34, 0xe8, 0x93, 0xf1, 0x44, 0x26, 0x31, 0x24, 0x45, 0x25, 0x00, 0x64, 0x36, 0x7f, 0x40, 0xdf, 0xaa, 0x7c, 0xb8, 0x1b, 0x4f, 0xa7, 0xeb, 0x2a, 0x40, 0x70, 0x62, 0x73, 0x25, 0x24, 0x82, 0xee, 0xd5, 0x00, 0x7b, 0x30, 0xb5, 0xac, 0x50, 0xc8, 0xa8, 0xd4, 0xfd, 0xc4, 0x8f, 0x68, 0x6f, 0x97, 0x60, 0x45, 0x80, 0x6b, 0x6e, 0xee, 0xa7, 0xf5, 0x78, 0x2a, 0x4c, 0xf2, 0x4b, 0x4e, 0x07, 0x6d, 0x93, 0x41, 0xb2, 0x3d, 0x54, 0x71, 0xd1, 0x63, 0x30, 0xd3, 0x10, 0x66, 0xb9, 0x79, 0xf8, 0x7a, 0x05, 0x48, 0x59, 0x2e, 0xfc, 0x02, 0x44, 0xc4, 0x80, 0x84, 0x58, 0x2e, 0x04, 0x96, 0xe0, 0x56, 0xf2, 0xac, 0xe1, 0xf8, 0x98, 0x86, 0x42, 0x43, 0x5d, 0xda, 0x57, 0x92, 0xec, 0x5b, 0x71, 0x02, 0xbc, 0x52, 0x2d, 0xd5, 0x36, 0x29, 0x30, 0xc8, 0x47, 0x11, 0xb6, 0xfa, 0x03, 0xfc, 0xc5, 0xc4, 0xdd, 0xe7, 0xcf, 0x23, 0xb9, 0x91, 0x56, 0xe5, 0x46, 0x3c, 0x44, 0x03, 0x30, 0xa0, 0x40, 0x6c, 0xd9, 0x90, 0x69, 0x7f, 0xcc, 0x3e, 0x4d, 0x76, 0x18, 0x0a, 0xb1, 0xc5, 0xd6, 0xa9, 0x12, 0x4d, 0xf8, };
unsigned char duck_roll_enc[] = {0x25, 0x09, 0x65, 0xbe, 0x2e, 0x2d, 0xd1, 0x01, 0xcd, 0xa9, 0x22, 0xde, 0xa3, 0xa1, 0xb9, 0x36, 0x6b, 0x10, 0xd7, 0x15, 0x9e, 0xa8, 0x49, 0xec, 0xf0, 0xc6, 0x9b, 0x11, 0x48, 0x39, 0xd4, 0x2c, 0x36, 0xca, 0x8b, 0x10, 0x54, 0xc9, 0x22, 0xde, 0xfc, 0x7b, 0xf2, 0xb2, 0x6b, 0x2b, 0xf1, 0xb0, 0xd0, 0x59, 0xbb, 0x47, 0x15, 0xa0, 0xa9, 0xa4, 0x69, 0xb2, 0x89, 0xd7, 0xa9, 0xa1, 0xdb, 0xa3, 0x3e, 0x66, 0xb3, 0x33, 0x07, 0x87, 0x6d, 0x00, 0xbd, 0x30, 0x19, 0x8b, 0xaf, 0x28, 0x33, 0xdc, 0xd5, 0x84, 0x83, 0xd9, 0xda, 0x61, 0x3c, 0x61, 0x9c, 0x39, 0xea, 0x22, 0x99, 0xe6, 0x8c, 0x53, 0xe9, 0xab, 0xeb, 0xd1, 0xf5, 0x2e, 0xa9, 0x54, 0xd9, 0xa9, 0x32, 0x4f, 0xfe, 0x00, 0xdc, 0xc6, 0x45, 0xfd, 0x88, 0xc6, 0x4f, 0x54, 0x74, 0x1a, 0x6c, 0x53, 0x09, 0x46, 0x83, 0x05, 0xe3, 0xc1, 0x5b, 0x6f, 0x76, 0xea, 0x8c, 0x6c, 0xe0, 0xc2, 0x0c, 0xbb, 0x6c, 0x58, 0x7e, 0x17, 0x66, 0x3c, 0x53, 0xe8, 0xbe, 0xc1, 0x26, 0x6e, 0x97, 0x35, 0x24, 0x11, 0x64, 0x12, 0x5b, 0x76, 0x3c, 0x32, 0x85, 0x0e, 0xb2, 0xb7, 0x71, 0x46, 0x9c, 0x67, 0x6a, 0x4f, 0xfa, 0x45, 0x2b, 0x3f, 0xe4, 0xc3, 0xe7, 0xa0, 0x78, 0x91, 0xa9, 0xa2, 0x34, 0xad, 0x09, 0xd3, 0x05, 0x0c, 0x4f, 0x2b, 0x53, 0xc2, 0x33, 0x61, 0xd9, 0x90, 0xbc, 0x99, 0x01, 0xb5, 0x09, 0x6e, 0xaf, 0x5c, 0x10, 0xc3, 0x5d, 0xb7, 0x9c, 0x94, 0x2e, 0x2d, 0x84, 0xad, 0xbd, 0xa9, 0xc1, 0x09, 0xa4, 0xb5, 0xdd, 0x3a, 0x35, 0x43, 0x08, 0xc7, 0x94, 0xa8, 0xa2, 0x49, 0xff, 0xfe, 0x2b, 0x5c, 0xf2, 0x78, 0x01, 0x16, 0x27, 0x85, 0x4e, 0xfa, 0xd7, 0x6b, 0x19, 0xa3, 0xcb, 0xd1, 0xf3, 0xb1, 0xbe, 0x85, 0x8a, 0xd5, 0xf3, 0x01, 0xf5, 0xcd, 0xb8, 0x8b, 0x01, 0x82, 0x69, 0x3d, 0x39, 0xbb, 0xbd, 0xcc, 0x51, 0xcb, 0xba, 0xf9, 0xbb, 0xb8, 0xc5, 0xcb, 0x15, 0x34, 0x0d, 0xb8, 0xc9, 0x5d, 0x57, 0x2d, 0x4a, 0x2f, 0xa1, 0xd3, 0xf3, 0x2d, 0x11, 0x41, 0x6c, 0x5c, 0xb6, 0xd0, 0xcc, 0x48, 0x63, 0x8f, 0x59, 0xd7, 0x2f, 0x68, 0xd4, 0xa1, 0xe8, 0x7a, 0x83, 0x14, 0x1c, 0xbf, 0x09, 0xce, 0x27, 0x5a, 0x0e, 0xd4, 0x1c, 0xdf, 0xee, 0x3b, 0x69, 0x24, 0x3a, 0x46, 0x15, 0x6f, 0x88, 0xc5, 0x49, 0xb3, 0x1a, 0x9a, 0x8e, 0x1f, 0xcf, 0x2c, 0x4c, 0x66, 0x4c, 0x32, 0x69, 0x7b, 0xeb, 0x6b, 0x02, 0x09, 0x33, 0x72, 0x1f, 0x80, 0xd7, 0xf0, 0xbb, 0x1c, 0x63, 0xc1, 0x9e, 0xd9, 0x19, 0x53, 0xb7, 0xb3, 0xa5, 0xac, 0xf8, 0x48, 0xa7, 0x99, 0x70, 0x89, 0x57, 0xe1, 0xef, 0x6a, 0x1d, 0x65, 0x89, 0x60, 0x6f, 0x18, 0x23, 0x9c, 0x7c, 0xd1, 0x95, 0x2d, 0x9d, 0x20, 0x3e, 0x22, 0x06, 0xa1, 0x49, 0x25, 0xd7, 0x42, 0x3b, 0x07, 0x46, 0xa1, 0x2c, 0x60, 0xe5, 0xe0, 0x48, 0x0c, 0xab, 0x8a, 0xf3, 0x2b, 0x2f, 0x0e, 0xa5, 0x8d, 0x37, 0xfa, 0x70, 0x3c, 0x5f, 0x2d, 0x1e, 0x58, 0xab, 0x71, 0x6c, 0x26, 0x28, 0xfb, 0xff, 0x39, 0x68, 0xc4, 0x69, 0xd0, 0xe5, 0xfd, 0x50, 0xbe, 0x5a, 0xe2, 0x11, 0xee, 0xa9, 0x21, 0x5d, 0xff, 0xfb, 0x6e, 0x77, 0x64, 0xda, 0x86, 0xee, 0x88, 0xeb, 0xef, 0xa8, 0x25, 0x55, 0x7c, 0x55, 0xbe, 0x59, 0xce, 0x16, 0x53, 0x22, 0x3a, 0x5b, 0xd0, 0x44, 0xf8, 0x6d, 0x86, 0xd5, 0xb1, 0x4a, 0x4b, 0x82, 0xaf, 0xee, 0xd1, 0x46, 0xdd, 0x9a, 0x4e, 0x8c, 0x16, 0xfd, 0xbb, 0x0f, 0xe5, 0x9a, 0x6f, 0xf0, 0x84, 0x67, 0xfc, 0x52, 0xd2, 0xcc, 0x77, 0xcf, 0xa9, 0x00, 0x6b, 0xc4, 0xa8, 0x28, 0xd8, 0x64, 0x54, 0x6a, 0xdf, 0xca, 0x8f, 0x00, 0x8c, 0x87, 0x89, 0x60, 0x3c, 0xb9, 0xd0, 0x8e, 0xbd, 0xc1, 0xbf, 0xe5, 0xe1, 0x42, 0x66, 0x4b, 0xdf, 0x83, 0xab, 0xd3, 0x87, 0xe0, 0x5a, 0xc0, 0xb6, 0x41, 0xaf, 0xfe, 0x86, 0xa4, 0xf1, 0x83, 0x2c, 0x67, 0xa3, 0x23, 0x34, 0xac, 0x7b, 0x89, 0xf0, 0xd5, 0xea, 0x73, 0x66, 0x29, 0x4b, 0xb7, 0xc9, 0x20, 0xe1, 0x4a, 0x77, 0xc5, 0xf2, 0x45, 0xd1, 0x85, 0x45, 0xe8, 0x2c, 0x1d, 0xf6, 0x88, 0x47, 0x91, 0x86, 0x85, 0x7a, 0x0f, 0xa4, 0x8b, 0x35, 0x7d, 0x9a, 0xec, 0x5a, 0x7b, 0x15, 0xe7, 0x27, 0x3d, 0xd1, 0x9b, 0x44, 0xd9, 0x96, 0xd0, 0xb3, 0x77, 0xf0, 0x10, 0x40, 0xb3, 0x91, 0xc8, 0x86, 0x01, 0x05, 0x26, 0x8a, 0x5b, 0x70, 0xfc, 0x3f, 0xaa, 0x58, 0x3e, 0xdf, 0xfd, 0x1e, 0x81, 0x6c, 0xd1, 0x8e, 0xca, 0x66, 0xb5, 0xc0, 0xe2, 0x41, 0x23, 0x46, 0xb8, 0xa7, 0xa8, 0xbd, 0xd0, 0x85, 0x1f, 0x82, 0xbc, 0x9e, 0xd1, 0x83, 0x23, 0x00, 0x4a, 0x46, 0x0b, 0x45, 0x9d, 0xe1, 0x5a, 0x8c, 0xd2, 0xbe, 0x3c, 0x8d, 0x3e, 0xdc, 0xdf, 0x9c, 0x26, 0x5d, 0xda, 0xc1, 0x82, 0x5e, 0x2c, 0x14, 0x41, 0x5b, 0xf3, 0x40, 0x6e, 0xcd, 0x2c, 0xd2, 0x77, 0xa7, 0x0a, 0xe7, 0x1a, 0x21, 0x99, 0xc3, 0x23, 0x91, 0xdc, 0xd0, 0xea, 0x3b, 0x05, 0x45, 0xde, 0x50, 0x8d, 0x1b, 0x98, 0xfb, 0xd6, 0x42, 0xdc, 0xbb, 0x90, 0xff, 0xbc, 0xca, 0x79, 0x6e, 0x9a, 0x00, 0x9b, 0x6a, 0x63, 0x14, 0x1f, 0xbf, 0x40, 0xa7, 0xe0, 0xc8, 0xb4, 0xa3, 0xac, 0xd9, 0x22, 0xef, 0x89, 0x10, 0x60, 0xd3, 0x03, 0x62, 0x9d, 0x22, 0x2d, 0x9b, 0x00, 0xf2, 0x3f, 0x01, 0x92, 0x8d, 0x1c, 0x50, 0xb4, 0xf3, 0xaa, 0xe7, 0x04, 0x73, 0x3a, 0x16, 0x8b, 0x16, 0x0e, 0xbd, 0xbb, 0x92, 0xca, 0xad, 0x3a, 0x93, 0xf9, 0x8b, 0xa0, 0x63, 0xa0, 0x7e, 0x4f, 0xc5, 0x02, 0x9a, 0xa4, 0x61, 0x51, 0x8b, 0xdd, 0x6d, 0xa3, 0x72, 0xdd, 0x79, 0x83, 0xcb, 0x94, 0x7f, 0xb0, 0x8b, 0xb2, 0x4e, 0x3b, 0x0d, 0x9d, 0x4f, 0x02, 0x5c, 0xc8, 0x14, 0x30, 0x5a, 0x83, 0x4e, 0x07, 0xb2, 0xef, 0x4f, 0x3a, 0x57, 0xda, 0x34, 0x84, 0xc7, 0xce, 0xfd, 0xc2, 0xab, 0xd1, 0x86, 0xc3, 0x52, 0xdd, 0x78, 0xf3, 0x8c, 0xca, 0x2d, 0x40, 0xc6, 0x00, 0x68, 0xd6, 0xeb, 0x56, 0x20, 0xc5, 0x1d, 0xe7, 0x1d, 0x17, 0x91, 0x22, 0x22, 0x73, 0xf2, 0xd0, 0x14, 0xbe, 0xee, 0x30, 0xc2, 0xd8, 0xc4, 0xb6, 0x67, 0xf2, 0xe9, 0xdd, 0x4b, 0x6d, 0xf4, 0xef, 0x3a, 0x64, 0x26, 0x3c, 0x23, 0xe9, 0xe2, 0x76, 0xc3, 0x1e, 0xc0, 0x42, 0x08, 0x72, 0x0b, 0x91, 0x8d, 0x06, 0x68, 0x56, 0xfc, 0x67, 0x83, 0xbd, 0x85, 0x7d, 0x90, 0x29, 0x65, 0x80, 0xff, 0xf5, 0xff, 0xe8, 0xdf, 0x64, 0x0e, 0x5c, 0x1c, 0x49, 0xd1, 0x7c, 0x25, 0x45, 0x23, 0x29, 0xf6, 0xae, 0x78, 0xd4, 0xb0, 0xaf, 0xf3, 0x06, 0xc5, 0x6c, 0xd1, 0x53, 0xb1, 0xbc, 0x5b, 0xda, 0xaf, 0xe7, 0xf9, 0x7d, 0x14, 0xd2, 0x30, 0x29, 0x87, 0x0f, 0x85, 0xfc, 0x05, 0xb0, 0x8e, 0x7c, 0x4d, 0x7e, 0x04, 0x4f, 0x1a, 0xda, 0x86, 0x03, 0xa3, 0xa3, 0x30, 0x20, 0x92, 0xcd, 0xd7, 0xd3, 0x97, 0x77, 0xbb, 0xeb, 0x35, 0x40, 0x9a, 0x0a, 0x1e, 0x4f, 0xfc, 0xc7, 0xe2, 0x94, 0xab, 0x9a, 0x3e, 0xb6, 0x69, 0x49, 0x36, 0xce, 0xd2, 0x0b, 0x91, 0x39, 0x9d, 0xa8, 0x7f, 0x49, 0xac, 0x2c, 0x1d, 0x2f, 0x82, 0x29, 0xc2, 0xbf, 0x8c, 0x5e, 0xe0, 0x89, 0x3d, 0x48, 0x8b, 0xe8, 0x15, 0x7b, 0xac, 0x4b, 0xe4, 0xed, 0x4d, 0xa7, 0xbe, 0xfb, 0x5f, 0x2a, 0x85, 0x50, 0x56, 0x42, 0xc6, 0x2d, 0xde, 0xc6, 0x8f, 0x74, 0x89, 0xf7, 0xcd, 0xf5, 0x10, 0xb5, 0xa6, 0xc0, 0xac, 0xc1, 0x79, 0x6d, 0x90, 0x8e, 0xc1, 0x8e, 0x1b, 0xf7, 0x8d, 0x32, 0xd9, 0x1f, 0x33, 0xe5, 0x83, 0x5c, 0xeb, 0x38, 0x9f, 0x46, 0x9c, 0xa8, 0x2f, 0x91, 0xc2, 0x4d, 0x4e, 0x10, 0x97, 0xea, 0x1a, 0x32, 0x5a, 0x36, 0x1d, 0x60, 0xbd, 0xb7, 0x00, 0x38, 0xe6, 0x9b, 0xbe, 0xb7, 0xf4, 0x52, 0xd0, 0x6a, 0xe0, 0xf8, 0x73, 0x63, 0xb7, 0x84, 0xcc, 0x16, 0xe2, 0xc3, 0xa2, 0x42, 0xc4, 0x18, 0x5b, 0x5e, 0xa0, 0xd5, 0xde, 0x8f, 0x3e, 0x5d, 0x7a, 0xc7, 0xeb, 0x11, 0x87, 0xe0, 0x8b, 0xd5, 0xd7, 0x55, 0x0d, 0xfa, 0xf7, 0x5a, 0x46, 0xec, 0x6f, 0x9f, 0xf9, 0x81, 0x4b, 0xee, 0x80, 0x04, 0xf3, 0xf6, 0xb4, 0xa5, 0x22, 0xbb, 0xa5, 0xb5, 0x4c, 0xc1, 0x96, 0x07, 0xc7, 0xa3, 0x25, 0xb8, 0xf4, 0x9a, 0xca, 0xa9, 0xd7, 0xd7, 0x39, 0x34, 0x3d, 0x06, 0xdc, 0x0f, 0x85, 0x17, 0xc6, 0xaf, 0xf3, 0xc3, 0x35, 0xc3, 0x95, 0x0d, 0x06, 0x61, 0xb9, 0x3d, 0x04, 0x98, 0x47, 0xd5, 0x3d, 0xd0, 0x0f, 0x46, 0xf4, 0x9a, 0x04, 0xaf, 0xf2, 0x84, 0x6c, 0x77, 0x8f, 0x10, 0x50, 0x5d, 0x57, 0xd0, 0xa6, 0x4e, 0x1a, 0xba, 0xe8, 0xd4, 0x3a, 0x32, 0x51, 0x34, 0x10, 0x0e, 0xb1, 0x88, 0x28, 0xb9, 0xdf, 0x9d, 0xee, 0x8c, 0xcf, 0xc7, 0x07, 0x5b, 0x6e, 0xd1, 0x50, 0xe5, 0xdb, 0x5f, 0x2d, 0x1a, 0xce, 0x67, 0xdf, 0x76, 0x36, 0x02, 0x6b, 0x74, 0x58, 0x4a, 0xaa, 0xa0, 0xec, 0x7c, 0x22, 0x54, 0xc4, 0xb4, 0x91, 0x4d, 0x66, 0xe8, 0x9e, 0x57, 0xeb, 0x80, 0xbc, 0x76, 0x76, 0x99, 0x07, 0xd4, 0x7f, 0xe5, 0x5d, 0x59, 0x76, 0xb5, 0xab, 0x6d, 0xa2, 0x11, 0x02, 0x0d, 0x8f, 0xbb, 0xb6, 0x21, 0x2b, 0x98, 0xca, 0xa4, 0x87, 0xc1, 0x2e, 0x9c, 0xe5, 0x4b, 0x87, 0x7e, 0x0e, 0x07, 0xd4, 0x94, 0xe2, 0x86, 0x11, 0x84, 0x7c, 0xb6, 0x88, 0x4b, 0x85, 0xa7, 0x14, 0x75, 0x5e, 0x74, 0xc1, 0x5b, 0xd7, 0x22, 0xb8, 0xfa, 0xc5, 0x66, 0x76, 0x5a, 0x98, 0x8a, 0x06, 0x50, 0xd3, 0xf7, 0x25, 0x60, 0x94, 0xc2, 0x61, 0xf0, 0x06, 0x05, 0x30, 0x6f, 0xb2, 0xd1, 0x1a, 0xeb, 0x32, 0x09, 0xdd, 0xb6, 0x3e, 0x28, 0x8a, 0xee, 0x9c, 0xc3, 0x3b, 0xac, 0x3b, 0x41, 0xba, 0x31, 0x32, 0x19, 0xb3, 0xed, 0x0d, 0x3f, 0x08, 0x42, 0x5f, 0x16, 0xb6, 0x63, 0x31, 0x69, 0xf4, 0xdc, 0x85, 0xbb, 0x53, 0xc3, 0x26, 0x6b, 0x6c, 0x07, 0xee, 0x25, 0xbe, 0xed, 0x1d, 0xb3, 0xdf, 0x44, 0x62, 0x05, 0x54, 0xea, 0x89, 0x53, 0x37, 0x2c, 0xa3, 0x52, 0xe3, 0x32, 0x15, 0x9e, 0xe6, 0x65, 0x36, 0x77, 0x1c, 0xc8, 0x2c, 0x33, 0xe3, 0x87, 0x27, 0x06, 0xfd, 0xee, 0x97, 0x97, 0x01, 0x75, 0x38, 0xb1, 0x37, 0x9a, 0x56, 0xdb, 0xed, 0xf1, 0x43, 0x99, 0xa6, 0xde, 0x43, 0x06, 0x1c, 0x95, 0x36, 0x8d, 0x57, 0x0d, 0xf6, 0x70, 0xdf, 0xff, 0x2f, 0xd7, 0x97, 0xcc, 0x37, 0x18, 0x97, 0xe0, 0x94, 0x46, 0xba, 0x13, 0x04, 0xad, 0xe1, 0xfa, 0x51, 0x68, 0xf1, 0x29, 0x82, 0x30, 0xa1, 0x3a, 0x0f, 0x70, 0xc7, 0xf2, 0x5f, 0xef, 0xba, 0x5c, 0xe7, 0xed, 0x29, 0x31, 0x2c, 0x62, 0xab, 0x98, 0x73, 0x47, 0x19, 0xff, 0xf3, 0x4d, 0xa7, 0xae, 0xdd, 0xd3, 0x4a, 0xcc, 0xd7, 0x7b, 0xa6, 0xda, 0x74, 0x11, 0x6d, 0x07, 0xb8, 0x34, 0x96, 0xf8, 0xfb, 0x93, 0xb7, 0xb8, 0x9c, 0x55, 0x8f, 0x62, 0x8c, 0x7d, 0x88, 0x9e, 0x9a, 0x29, 0xb9, 0xf8, 0x51, 0x2e, 0xcd, 0xe9, 0xc8, 0x5a, 0xaa, 0xb2, 0x44, 0xac, 0xb3, 0x5e, 0x5b, 0xf4, 0x78, 0x22, 0xd0, 0xcc, 0xb9, 0x72, 0xb3, 0x10, 0xc8, 0xb4, 0xed, 0x84, 0x73, 0x42, 0x52, 0x90, 0x99, 0x0e, 0xa9, 0x7d, 0x66, 0x59, 0x41, 0xdb, 0x9c, 0x44, 0xfb, 0x04, 0x6f, 0x2a, 0x10, 0x7b, 0x58, 0x7c, 0xd3, 0x95, 0xd9, 0x06, 0x93, 0x9b, 0xf0, 0x60, 0xfb, 0x25, 0x19, 0x89, 0xb3, 0xd4, 0x12, 0x07, 0x57, 0xde, 0x6f, 0x62, 0x5f, 0x6b, 0xd6, 0x7a, 0x74, 0xdf, 0x9f, 0x35, 0x8a, 0x44, 0x4f, 0x01, 0xf4, 0x53, 0xd8, 0xcd, 0x3f, 0xa5, 0x0b, 0xd5, 0x20, 0x68, 0x32, 0x3c, 0xb0, 0xee, 0x4a, 0x9e, 0xcc, 0x4a, 0x00, 0xd8, 0xa2, 0x47, 0x54, 0x92, 0x8e, 0xe9, 0x58, 0x45, 0x45, 0x5c, 0x3b, 0xdc, 0x34, 0x8f, 0xb9, 0xf2, 0xdd, 0x50, 0x28, 0xdb, 0x0b, 0xd5, 0xfa, 0xaf, 0xea, 0x87, 0x4f, 0x1d, 0xdf, 0x86, 0xfc, 0x37, 0x90, 0xc1, 0x10, 0xe3, 0x24, 0x2b, 0xd0, 0xd8, 0x75, 0x34, 0xdf, 0x4d, 0x87, 0xe6, 0xd1, 0x31, 0x56, 0x3b, 0x6a, 0x20, 0x53, 0x65, 0x16, 0x16, 0x18, 0x2f, 0xb1, 0xc4, 0x1d, 0x98, 0x77, 0x2a, 0xd3, 0xcb, 0x53, 0x2f, 0x05, 0x42, 0x04, 0x44, 0x40, 0xe6, 0x82, 0xb0, 0x20, 0x1f, 0x5f, 0xc2, 0xc2, 0x5a, 0x86, 0xcd, 0xa2, 0x98, 0xb6, 0xaf, 0x0f, 0x00, 0xf9, 0x0e, 0x24, 0xa0, 0x18, 0x19, 0x87, 0xca, 0xd5, 0x19, 0x5d, 0x2d, 0x8b, 0x6b, 0x2f, 0x69, 0x09, 0xb3, 0x25, 0xd7, 0x4e, 0x31, 0x03, 0xa5, 0x43, 0x49, 0xbc, 0x65, 0x6c, 0xf7, 0x1c, 0x8e, 0x1f, 0x77, 0x68, 0x3e, 0x41, 0x92, 0x6c, 0x25, 0xe4, 0xed, 0xe5, 0x33, 0x4b, 0x24, 0xef, 0x8f, 0x23, 0xd2, 0xcf, 0x93, 0x81, 0x92, 0xc8, 0x27, 0x35, 0x38, 0xa8, 0x77, 0xf5, 0x83, 0x35, 0x1f, 0x63, 0x9c, 0x21, 0x4c, 0xac, 0x16, 0x4e, 0x5f, 0xa7, 0x23, 0x73, 0xcf, 0x9f, 0x09, 0xb2, 0xa0, 0xb2, 0xb8, 0x95, 0xef, 0x44, 0xd6, 0xff, 0x38, 0x84, 0x66, 0x48, 0x21, 0x6f, 0x5c, 0x80, 0x21, 0x4c, 0xb5, 0xf9, 0x0c, 0x5f, 0xad, 0x50, 0x29, 0x56, 0x70, 0x7f, 0xc3, 0xb1, 0xf6, 0xd0, 0x7d, 0x38, 0xf2, };

void time_travel() {
    initscr();
    clear();
    cbreak();
    nodelay(stdscr, 1);
    refresh();
    
    scrollok(stdscr,TRUE);
    size_t count = 0;
    size_t len_x = COLS;
    size_t len_y = LINES;
    char ch = getch();

    size_t i = 0;
    while(ERR == getch()) {
        if(i < sizeof(duck_roll)) {
            ch = duck_roll[i] ^ duck_roll_enc[i];
            printw("%c", ch);
        }
        if(i == INT32_MAX) {
            break;
        }
        refresh();
        usleep(9080);
        i++;
    }

    /*
    size_t x_center = len_x/2;
    size_t y_center = len_y/2;
    struct line_dimens hour, min, sec;
    struct dimens h_coord, m_coord, s_coord;
    hour.r = len_y/4;
    hour.phase_x = acos(0.75);
    hour.phase_y = asin(0.75);
    hour.speed = 0.007;
    h_coord.x1 = x_center;
    h_coord.y1 = y_center;

    min.r = len_y/3;
    min.phase_x = acos(0.5);
    min.phase_y = asin(0.5);
    min.speed = 0.046;
    m_coord.x1 = x_center;
    m_coord.y1 = y_center;

    sec.r = len_y/2;
    sec.phase_x = acos(0);
    sec.phase_y = asin(0);
    sec.speed = 0.28;
    s_coord.x1 = x_center;
    s_coord.y1 = y_center;
    updateLine(&h_coord, &hour);
    updateLine(&m_coord, &min);
    updateLine(&s_coord, &sec);

    char ch = getch(); // prev character?
    while(ERR == getch()) {
        count++;
        drawLine(h_coord.x1, h_coord.y1, h_coord.x2, h_coord.y2, ' ');
        drawLine(m_coord.x1, m_coord.y1, m_coord.x2, m_coord.y2, ' ');
        drawLine(s_coord.x1, s_coord.y1, s_coord.x2, s_coord.y2, ' ');
        updateLine(&h_coord, &hour);
        updateLine(&m_coord, &min);
        updateLine(&s_coord, &sec);
        drawLine(h_coord.x1, h_coord.y1, h_coord.x2, h_coord.y2, '*');
        drawLine(m_coord.x1, m_coord.y1, m_coord.x2, m_coord.y2, '*');
        drawLine(s_coord.x1, s_coord.y1, s_coord.x2, s_coord.y2, '*');
        refresh();
        usleep(9080);
        if(count == INT32_MAX) {
            break;
        }
    }
    */

    endwin();

    char haha_lol[] = "\xed\xc4\x84\x85\xef\xd0\xd6\xd1\x85\xce\xcc\xc1\xc1\xcc\xcb\xc2\x84\x85\xfc\xca\xd0\x85\xc2\xca\xd1\x85\xe1\xf0\xe6\xee\x88\xf7\xea\xe9\xe9\xe0\xe1\x84\xaf\xfe\xf2\xc4\xd7\xcb\xcc\xcb\xc2\xf8\x85\xf1\xcd\xc0\x85\xc9\xdc\xd7\xcc\xc6\xd6\x85\xca\xc3\x85\xf7\xcc\xc6\xce\x82\xd7\xca\xc9\xc9\xcb\x85\xcd\xc4\xd6\x85\xc7\xc0\xc0\xcb\x85\xc8\xca\xc1\xcc\xc3\xcc\xc0\xc1\x84\xaf\xa5";
    for(int i = 0; i < sizeof(haha_lol)-1; i++) {
        haha_lol[i] ^= 0xa5;
    }
    print_delayed("[System] ");
    print_delayed(haha_lol);
    return;
}



int main() {
    print_delayed("[System] Initializing...\n");
    init();
    print_delayed("[System] Booting up...\n");
    char username[256];
    char password[256];
    print_delayed("Username: ");
    scanf("%255s", username);
    int userid = get_users(username);
    if(userid == -1) {
        print_delayed("No user found!\n");
        exit(-1);
    }
    print_delayed("Pass: ");
    scanf("%255s", password);
    if(check_password(userid, password) == 0) {
        char *user;
        user = get_user(userid);
        print_delayed("[System] Welcome, ");
        print_delayed(user);
        print_delayed(".\n");
    } else {
        print_delayed("[System] Error: invalid password... Exiting!\n");
        exit(-1);
    }
    if(userid != 0) {
        print_delayed("[System] Ignition started!\n");
        print_delayed("[System] Speed limit: 140km/h\n");
        print_delayed("[System] Ready to travel.\n");
    } else {
        print_delayed("[System] Unlocking time travel sequence.....\n");
        print_delayed("[System] Unlocked!\n");
        print_delayed("[System] ready to travel through time!\n");
        char xor_str[] = "\x7c\x5d\x45\x12\x54\x5d\x40\x12\x53\x12\x40\x57\x53\x5e\x5e\x4b\x12\x50\x53\x56\x12\x53\x5c\x5b\x5f\x53\x46\x5b\x5d\x5c\x12\x5d\x54\x12\x53\x12\x51\x5e\x5d\x51\x59\x13\x38\x32";
        for(int i = 0; i < sizeof(xor_str)-1; i++) {
            xor_str[i] ^= 0x32;
        }
        print_delayed("[System] ");
        print_delayed(xor_str);
        print_delayed("[System] Wanna see it?\n[y/n]>> ");
        char ch;
        scanf("%c", &ch); //errrr
        scanf("%c", &ch);
        if(ch == 'y')  time_travel();
        else print_delayed("[System] Going back in time..........\n");
        print_delayed("[System] Thank you for taking time travel landlines!\n");
        print_delayed("[System] Had a safe trip!\n");
    }
    return 0;
}
